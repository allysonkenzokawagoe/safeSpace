<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Seguro | Apoio Estudantil</title>
    <link rel="icon" type="image/png" href="src/icon.png">
    <link rel="apple-touch-icon" href="src/icon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="css/chat-estudante.css">
</head>
<body>
    <div class="container-fluid py-4">
        <div class="row g-4 justify-content-center">
            
            <div class="col-lg-3">
                <div class="history-panel">
                    <div class="card-header"> 
                        <h6 class="mb-0"><i class="bi bi-clock-history me-2"></i> Minhas Sessões</h6>
                    </div>
                    <div class="history-list-body">
                        <div class="history-item active" data-session-id="session-active" onclick="loadChat(this)">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="fw-bold text-dark">Sessão Atual</span>
                                <span class="chat-status-badge status-aberto">Aberta</span>
                            </div>
                            <small class="text-muted d-block">Psicóloga Maria (Hoje)</small>
                            <small class="text-muted d-block mt-1">Status: Respondendo...</small>
                        </div>
                        <div class="history-item" data-session-id="session-bullying" onclick="loadChat(this)">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="fw-semibold">Bullying Escolar</span>
                                <span class="chat-status-badge status-fechado">Fechada</span>
                            </div>
                            <small class="text-muted d-block">Profissional João (20/SET)</small>
                            <small class="text-muted d-block mt-1">Tópico: Orientação legal</small>
                        </div>
                        <div class="history-item" data-session-id="session-ansiedade" onclick="loadChat(this)">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="fw-semibold">Ansiedade e Provas</span>
                                <span class="chat-status-badge status-fechado">Fechada</span>
                            </div>
                            <small class="text-muted d-block">Profissional Ana (15/AGO)</small>
                            <small class="text-muted d-block mt-1">Tópico: Técnicas de relaxamento</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-9">
                <div class="chat-container" id="chatInterface">
                    
                    <div class="chat-header d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <div class="avatar me-3">PA</div>
                            <div>
                                <h5 class="mb-0 fw-bold">Orientação e Apoio</h5>
                                <small class="online-status">
                                    <span class="online-dot"></span> Profissional online
                                </small>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-secondary btn-sm" title="Ajuda"><i class="bi bi-question-circle"></i></button>
                            <button class="btn btn-outline-secondary btn-sm" title="Sair da Conversa"><i class="bi bi-x-lg"></i></button>
                        </div>
                    </div>

                    <div class="chat-messages" id="chatMessages">
                        <div class="text-center text-muted mb-4 small">Lembre-se: **Suas conversas são 100% confidenciais e seguras.**</div>
                        
                        <div class="text-center text-muted my-3 small text-uppercase fw-semibold"><i class="bi bi-calendar-check me-1"></i> Sessão Anterior: Ontem, 16:00</div>
                        <div class="message professional">
                            <div class="message-content"><p class="mb-0">Agradeço por compartilhar seus sentimentos. É muito importante que você saiba que não está sozinho(a). Como se sentiu após nossa última conversa?</p><div class="message-time">Ontem, 16:05</div></div>
                        </div>
                        <div class="message user">
                            <div class="message-content"><p class="mb-0">Fiquei um pouco melhor, obrigado(a). Me ajudou a pensar sobre o que fazer.</p><div class="message-time">Ontem, 16:08</div></div>
                        </div>

                        <div class="text-center text-muted my-3 small text-uppercase fw-semibold"><i class="bi bi-calendar-check me-1"></i> Hoje</div>
                        <div class="message professional">
                            <div class="message-content"><p class="mb-0">Olá! Sou a psicóloga Maria. Como posso te ajudar hoje?</p><div class="message-time">14:30</div></div>
                        </div>
                        <div class="message user">
                            <div class="message-content"><p class="mb-0">Oi, estou passando por alguns problemas na escola...</p><div class="message-time">14:32</div></div>
                        </div>
                        <div class="message professional">
                            <div class="message-content"><p class="mb-0">Entendo. Você está em um espaço seguro aqui. Pode me contar o que está acontecendo?</p><div class="message-time">14:33</div></div>
                        </div>
                    </div>

                    <div class="chat-input">
                        <div class="row g-2 align-items-center">
                            <div class="col">
                                <input type="text" class="form-control" id="messageInput" placeholder="Compartilhe seus pensamentos. Suas mensagens são anônimas." onkeypress="handleKeyPress(event)">
                            </div>
                            <div class="col-auto">
                                <button class="btn btn-primary" onclick="sendMessage()"><i class="bi bi-send-fill"></i></button>
                            </div>
                        </div>
                        <small class="text-muted d-block text-center mt-2 small">O profissional responderá o mais rápido possível.</small>
                    </div>
                </div>
            </div>

            </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script type="module" src="js/chat.estudante.js"></script> 
</body>
</html>